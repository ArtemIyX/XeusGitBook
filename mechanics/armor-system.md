---
description: Система брони и повреждений
---

# Armor system

## Одежда

Одежда обладает возможностью обеспечивать защиту от неблагоприятных условий, представляющих опасность для жизнедеятельности. Каждый компонент брони обладает уникальным уровнем сопротивления по отношению к определенному типу повреждений, который выражается в числовом значении, на которое происходит деление.

## BLV

BLV - Base limb vulnerability (Базовая уязвимость конечности)

$$
BLV ∈ [0;2]
$$

_BLV На примере куртки_

<table><thead><tr><th width="238">Тип урона</th><th>Значение</th></tr></thead><tbody><tr><td>Колотый</td><td>1.1</td></tr><tr><td>Режущий</td><td>2</td></tr><tr><td>Рубящий</td><td>1.1</td></tr><tr><td>Ударный</td><td>1</td></tr><tr><td>Пулевой</td><td>1</td></tr><tr><td>Рваный</td><td>1.5</td></tr></tbody></table>

### Расчет урона

$$
y = \frac{a}{r - BLV + 1}
$$

<table><thead><tr><th width="184">Переменная</th><th>Описание</th></tr></thead><tbody><tr><td>a</td><td>Количество наносимого урона</td></tr><tr><td>r</td><td>Сопротивление этого типа одежды</td></tr><tr><td>BLV</td><td>Базовая уязвимость конечности</td></tr></tbody></table>

#### Примеры расчета урона

_Пример расчета формул при ударе тяжелым топором с хар-ками Ру-40, У10:_

`damage = 40 / (1.1 - бук + 1) // 36.36 Рубящего урона`&#x20;

`damage = 10 / (1.0 - бук + 1) // 10.00 Ударного урона`

## Ячейки для одежды

Любая одежда, бронежилет, например, должен быть размещен только в специально предназначенном слоте для бронежилета и не может быть помещен в слот, предназначенный для другого типа одежды, такого как штаны.

Кроме того, броня может предоставлять дополнительные слоты инвентаря, что позволяет носителю хранить и переносить больше предметов. Эти дополнительные ячейки инвентаря могут быть использованы для размещения различных предметов, включая медицинские принадлежности, дополнительные боеприпасы или другие необходимые инструменты.

## Перекрытие

Броня распространяется не только на соответствующие ей части тела, но и на соседние. Например, куртка может защищать еще и живот с руками. Защита зависит от модификатора покрытия. Чем он значительнее, тем больше защита.&#x20;

_Покрытие на примере куртки_

<table><thead><tr><th width="235">Часть тела</th><th>Перекрытие</th></tr></thead><tbody><tr><td>Голова</td><td>0.0</td></tr><tr><td>Грудь</td><td>1.0</td></tr><tr><td>Живот</td><td>1.0</td></tr><tr><td>Правая рука</td><td>0.5</td></tr><tr><td>Левая рука</td><td>0.5</td></tr><tr><td>Правая нога</td><td>0.0</td></tr><tr><td>Левая нога</td><td>0.0</td></tr></tbody></table>

### Расчет перекрытия&#x20;

$$
y = (a-1 )* p)+1
$$

<table><thead><tr><th width="159"></th><th></th></tr></thead><tbody><tr><td>a</td><td>Защита</td></tr><tr><td>p</td><td>Покрытие конечности</td></tr></tbody></table>

То-есть, для груди и живота процент защиты соответствует вышеизложенному. \
Для рук выходит такая формула:

`overlap = ((1.1 - 1) * 0.5) + 1 // 1.05`\
`damage = 40 / (1.1 - BLV + 1 ) // 38.09`\


## Совокупность эффектов

Эффекты от разной брони работают в совокупности, например на руке есть защита от рубящего урона от наплечника, налокотника и куртки 1.1, 1.1 и 1.05 соответственно. Результат рассчитывается так:

`r = (1.1 + 1.1 + 1.05) // 1.25`\
`damage = 40 \ (r - 1.0 + 1) // 32.0`

## Финальная формула

$$
P_{i} =(((m_{i} - 1) * h_{i}) + 1) - b + 1
$$

{% hint style="info" %}
i - индекс элемента на конечности
{% endhint %}

$$
C=(\sum_{i=0}^{n-1}P_{i}) - n
$$

{% hint style="info" %}
С - сумма результатов всех элементов брони на данной конечности
{% endhint %}

$$
y =\frac{V}{C}
$$

<table><thead><tr><th width="88"></th><th></th></tr></thead><tbody><tr><td>V</td><td>Входной урон</td></tr><tr><td>C</td><td>Коэфециент защиты для данной конечности</td></tr><tr><td>P</td><td>Защита каждого элемента брони на данной конечности</td></tr><tr><td>n</td><td>Количество элементов брони на данной конечности</td></tr><tr><td>m</td><td>Модификатор защиты</td></tr><tr><td>h</td><td>Модификатор перекрытия</td></tr><tr><td>b</td><td>BLV, Base limb vulnerability (Базовая уязвимость конечности)</td></tr></tbody></table>

```cpp
double UArmor::CalculateBlockElement(double blv) const{
    return (((m - 1) * h) + 1) - blv + 1;
}
double UManager::CalculateBlockCoeficient(EHitbox hitbox, double blv) const{
    auto armor = GetArmor(hitbox);
    double sum = 0.0f;
    for(const auto& var : armor){
        sum += var->CalculateBlockElement(blv);
    }
    return sum - armor.Num();
}
double UManager::CalculateDamage(float initialDamage, 
    EDamageType damageType, EHitbox hitbox) const{
    double blv = GetBlv(damageType, hitbox);
    double c = CalculateBlockCoeficient(hitbox, blv);
    return initialDamage / c;
}
```
